# –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã—Ö —Ñ—Ä–æ–Ω—Ç–æ–≤ (`front_analyzer.py`)

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `front_analyzer.py` —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã—Ö —Ñ—Ä–æ–Ω—Ç–æ–≤** –Ω–∞ –æ—Å–Ω–æ–≤–µ **–º–µ—Ç–µ–æ–¥–∞–Ω–Ω—ã—Ö** —Å **—É—Ä–æ–≤–Ω—è 850 –≥–ü–∞**, **MSLP**, **–æ—Å–∞–¥–∫–æ–≤**, **–≤–ª–∞–∂–Ω–æ—Å—Ç–∏**, **–≤–µ—Ç—Ä–∞** –∏ **—Ü–∏—Ñ—Ä–æ–≤–æ–π –º–æ–¥–µ–ª–∏ —Ä–µ–ª—å–µ—Ñ–∞**.

–¶–µ–ª—å:
- üîç **–ù–∞–π—Ç–∏** –ª–∏–Ω–∏–∏ —Ñ—Ä–æ–Ω—Ç–æ–≤ (—Ç—ë–ø–ª—ã–π, —Ö–æ–ª–æ–¥–Ω—ã–π, –æ–∫–∫–ª—é–∑–∏—è)
- üè∑Ô∏è **–ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å** –∏—Ö —Ç–∏–ø
- üßÆ **–û—Ü–µ–Ω–∏—Ç—å** –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å
- üìç **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å** –≥–µ–æ–º–µ—Ç—Ä–∏—é (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
- ‚è≥ **–û—Ü–µ–Ω–∏—Ç—å** –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–∞–¥ —Ç–æ—á–∫–æ–π

---

## –ê–ª–≥–æ—Ä–∏—Ç–º

### 1. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ (FI)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å:
FI(x,y) = |‚àáŒ∏e| * (1 + wq * |‚àáq|)

–ì–¥–µ:
- `Œ∏e` ‚Äî —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (850 –≥–ü–∞)
- `q` ‚Äî —É–¥–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å (850 –≥–ü–∞)
- `wq` ‚Äî –≤–µ—Å –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.75)

–ü–æ—Ä–æ–≥: `FI > 10.0` (–ö / 1000 –∫–º)

---

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –±–∞—Ä–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ

- –ü–æ–∏—Å–∫ **–±–∞—Ä–∏—á–µ—Å–∫–∏—Ö –ª–æ–∂–±–∏–Ω** (–ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏–º—É–º–æ–≤ MSLP)
- –û—Ç–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ **–∞–Ω—Ç–∏—Ü–∏–∫–ª–æ–Ω–æ–≤** (P > 1025 –≥–ü–∞)

---

### 3. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ –æ—Å–∞–¥–∫–∞–º –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏

- –ù–∞–ª–∏—á–∏–µ **–æ—Å–∞–¥–∫–æ–≤** > 0.5 –º–º/2—á
- **–°–∫–∞—á–æ–∫ —Ç–æ—á–∫–∏ —Ä–æ—Å—ã** ‚â• 2¬∞C –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ ‚â§ 200 –∫–º

---

### 4. –¢–∏–ø–∏–∑–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–∞

–ù–∞ –æ—Å–Ω–æ–≤–µ:
- –£–≥–ª–∞ –Ω–∞–∫–ª–æ–Ω–∞ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–ø–æ ‚àáŒ∏e)
- –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞
- –ü–æ–ª–æ–∂–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ü–∏–∫–ª–æ–Ω–∞

–¢–∏–ø—ã:
- `warm` ‚Äî —Ç—ë–ø–ª—ã–π —Ñ—Ä–æ–Ω—Ç
- `cold` ‚Äî —Ö–æ–ª–æ–¥–Ω—ã–π —Ñ—Ä–æ–Ω—Ç
- `occlusion` ‚Äî –æ–∫–∫–ª—é–∑–∏—è
- `unknown` ‚Äî –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π

---

### 5. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (–∞–Ω—Å–∞–º–±–ª—å-–ø–æ–¥—Ö–æ–¥)

–§—Ä–æ–Ω—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—ã–º, –µ—Å–ª–∏ **‚â•3 –º–µ—Ç–æ–¥–æ–≤** –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –µ–≥–æ –Ω–∞–ª–∏—á–∏–µ:

| –ú–µ—Ç–æ–¥ | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç | –ü–æ—Ä–æ–≥ |
|-------|-----------|-------|
| –ì—Ä–∞–¥–∏–µ–Ω—Ç Œ∏e | –¢–µ—Ä–º–∏—á–µ—Å–∫–∞—è –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å | ‚â• 8 K/1000 –∫–º |
| –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | div < ‚Äì1¬∑10‚Åª‚Åµ —Å‚Åª¬π |
| –û—Å–∞–¥–∫–∏ | –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑—É–µ–º–æ—Å—Ç—å | TP > 0.5 –º–º/2—á |
| –ë–∞—Ä–∏—á–µ—Å–∫–∞—è –ª–æ–∂–±–∏–Ω–∞ | –°–∏–Ω–æ–ø—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ | ŒîP ‚â• 3 –≥–ü–∞ |
| –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ç–æ—á–∫–∏ —Ä–æ—Å—ã | –í–ª–∞–∂–Ω–æ—Å—Ç–Ω—ã–π —Å–∫–∞—á–æ–∫ | ‚â• 0.02 K/km |

---

### 6. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤

- **–ê–Ω—Ç–∏—Ü–∏–∫–ª–æ–Ω—ã** ‚Äî —Ñ—Ä–æ–Ω—Ç—ã –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- **–û—Ä–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** ‚Äî —Å–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å
- **–†–∞–∑–º—ã—Ç—ã–µ —Ñ—Ä–æ–Ω—Ç—ã** ‚Äî —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ —à–∏—Ä–∏–Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–π –∑–æ–Ω—ã

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –§—É–Ω–∫—Ü–∏—è: `detect_fronts(...)`

```python
from scripts.meteo._processes.front_analyzer import detect_fronts

result = detect_fronts(
    theta_e=theta_e_grid,  # (np.ndarray) Œ∏e –Ω–∞ 850 –≥–ü–∞
    q=q_grid,              # (np.ndarray) —É–¥–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å
    mslp=mslp_grid,        # (np.ndarray) –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ—Ä—è
    tp=tp_grid,            # (np.ndarray) –æ—Å–∞–¥–∫–∏ –∑–∞ 2—á
    dewpoint=dewpoint_grid,# (np.ndarray) —Ç–æ—á–∫–∞ —Ä–æ—Å—ã
    wind_u=wind_u_grid,    # (np.ndarray) zonal-—Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è –≤–µ—Ç—Ä–∞
    wind_v=wind_v_grid,    # (np.ndarray) meridional-—Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è –≤–µ—Ç—Ä–∞
    dem=dem_grid           # (np.ndarray, optional) —Ü–∏—Ñ—Ä–æ–≤–∞—è –º–æ–¥–µ–ª—å —Ä–µ–ª—å–µ—Ñ–∞
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# {
#   "fi": np.ndarray,           # —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
#   "front_mask": np.ndarray,   # –±–∏–Ω–∞—Ä–Ω–∞—è –º–∞—Å–∫–∞ —Ñ—Ä–æ–Ω—Ç–æ–≤
#   "front_type": np.ndarray,   # —Ç–∏–ø —Ñ—Ä–æ–Ω—Ç–∞ ('warm', 'cold', 'occlusion', 'unknown')
#   "confidence": np.ndarray,   # —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ (0-5)
#   "summary": {
#     "total_front_cells": int, # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è—á–µ–µ–∫ —Å —Ñ—Ä–æ–Ω—Ç–∞–º–∏
#     "avg_confidence": float,  # —Å—Ä–µ–¥–Ω—è—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å
#     "types": dict             # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ—Ä–æ–Ω—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º
#   }
# }
from scripts.meteo._processes.front_analyzer import extract_front_geometry

coords = extract_front_geometry(
    front_mask=result['front_mask'],
    lat_grid=lat_grid,
    lon_grid=lon_grid
)
# coords = [(lat1, lon1), (lat2, lon2), ...]

from scripts.meteo._processes.front_analyzer import estimate_pass_time

pass_time = estimate_pass_time(
    front_coords=coords,
    wind_field=(wind_u, wind_v),
    target_lat=55.75,
    target_lon=37.62
)
# pass_time = 3.0  # –≤ —á–∞—Å–∞—Ö

–ü–∞—Ä–∞–º–µ—Ç—Ä
–ó–Ω–∞—á–µ–Ω–∏–µ
–û–ø–∏—Å–∞–Ω–∏–µ
DEFAULT_WQ
0.75
–≤–µ—Å –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤ FI
FI_THRESHOLD
10.0
–ø–æ—Ä–æ–≥ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
TP_THRESHOLD
0.5
–ø–æ—Ä–æ–≥ –æ—Å–∞–¥–∫–æ–≤ (–º–º/2—á)
PRESSURE_THRESHOLD
3.0
–ø–æ—Ä–æ–≥ –±–∞—Ä–∏—á–µ—Å–∫–æ–π –ª–æ–∂–±–∏–Ω—ã (–≥–ü–∞)
ROCK_POINT_THRESHOLD
2.0
—Å–∫–∞—á–æ–∫ —Ç–æ—á–∫–∏ —Ä–æ—Å—ã (¬∞C)
CONFIDENCE_THRESHOLD
3
–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–∞
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∞–Ω–Ω—ã–º
‚úÖ –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª–µ–π –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å
‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–µ—Ç–∫–∏: ~0.1‚Äì0.25¬∞ (10‚Äì25 –∫–º)
‚úÖ –í—Ä–µ–º—è: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ (–æ–¥–∏–Ω —Å—Ä–µ–∑)
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
–ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞:

Hewson (1998) ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç Œ∏e + –≤–ª–∞–∂–Ω–æ—Å—Ç—å
–ì—É—â–∏–Ω–∞ (–ª–µ–∫—Ü–∏—è 6) ‚Äî –∫–æ–º–ø–ª–µ–∫—Å —Å–∏–Ω–æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
Simmons & Burridge (1986) ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 850 –≥–ü–∞
–ü—Ä–∞–∫—Ç–∏–∫—É –ì–∏–¥—Ä–æ–º–µ—Ç—Ü–µ–Ω—Ç—Ä–∞ –†–§ –∏ ECMWF ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–∏–∑–µ–º–Ω–æ–π –∫–∞—Ä—Ç–æ–π