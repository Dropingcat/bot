project_root/
‚îú‚îÄ‚îÄ bot.py                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ + –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îú‚îÄ‚îÄ process_manager.py        # –ù–û–í–û–ï: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îú‚îÄ‚îÄ config/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ bot_config.py
‚îÇ   ‚îú‚îÄ‚îÄ db_config.py
‚îÇ   ‚îú‚îÄ‚îÄ process_config.py     # –ù–û–í–û–ï: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ logging_config.py     # –ù–û–í–û–ï: –ö–æ–Ω—Ñ–∏–≥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ core/                     # –Ø–¥—Ä–æ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ db/                   # –ú–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ central_db.py     # –†–∞–±–æ—Ç–∞ —Å –¶–ë–î (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–æ—Ñ–∏–ª–∏, —Ä–∞—Å—Ç–µ–Ω–∏—è)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local_db_weather.py # –õ–æ–∫–∞–ª –ë–î –ø–æ–≥–æ–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local_db_meteo.py # –õ–æ–∫–∞–ª –ë–î –º–µ—Ç–µ–æ-–≤–ª–∏—è–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local_db_atmosphere.py # –õ–æ–∫–∞–ª –ë–î –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local_db_agro.py  # –õ–æ–∫–∞–ª –ë–î –∞–≥—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ process_log_db.py # –ù–û–í–û–ï: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ models/               # ML-–º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ meteo_model.py    # –ú–æ–¥–µ–ª—å –≤–ª–∏—è–Ω–∏—è –ø–æ–≥–æ–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agro_model.py     # –ú–æ–¥–µ–ª—å –∞–≥—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health_predictor.py # –ù–û–í–û–ï: –ú–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ utils/                # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_client.py     # –û–±—ë—Ä—Ç–∫–∞ –¥–ª—è API-–∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_processor.py # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ coordinate_manager.py # –ù–û–í–û–ï: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ error_handler.py  # –ù–û–í–û–ï: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validator.py      # –ù–û–í–û–ï: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cache_manager.py  # –ù–û–í–û–ï: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
‚îÇ   ‚îî‚îÄ‚îÄ monitoring/           # –ù–û–í–û–ï: –°–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ       ‚îú‚îÄ‚îÄ health_checker.py # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ       ‚îú‚îÄ‚îÄ performance_monitor.py # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ       ‚îî‚îÄ‚îÄ anomaly_detector.py # –î–µ—Ç–µ–∫—Ç–æ—Ä –∞–Ω–æ–º–∞–ª–∏–π
‚îú‚îÄ‚îÄ scripts/                  # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ weather/              # –ú–æ–¥—É–ª—å "–ü–æ–≥–æ–¥–∞"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ weather_today_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ weather_forecast_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ weather_graph_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ baric_map_daily_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ baric_map_weekly_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py       # –ù–û–í–û–ï: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _processes/       # –ù–û–í–û–ï: –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ–≥–æ–¥—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ data_fetcher.py # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ validator.py  # –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ interpolator.py # –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ formatter.py  # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ meteo/                # –ú–æ–¥—É–ª—å "–ú–µ—Ç–µ–æ"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_profile_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ impact_forecast_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ front_forecast_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ baric_anomaly_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _processes/       # –ù–û–í–û–ï: –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –º–µ—Ç–µ–æ
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ front_analyzer.py # –ê–Ω–∞–ª–∏–∑ —Ñ—Ä–æ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ stress_calculator.py # –†–∞—Å—á–µ—Ç —Å—Ç—Ä–µ—Å—Å-–∏–Ω–¥–µ–∫—Å–∞
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ health_predictor.py # –ü—Ä–æ–≥–Ω–æ–∑ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ alarm_system.py # –°–∏—Å—Ç–µ–º–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ atmosphere/           # –ú–æ–¥—É–ª—å "–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ moon_phase_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sky_transparency_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ light_pollution_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _processes/       # –ù–û–í–û–ï: –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ phase_calculator.py # –†–∞—Å—á–µ—Ç —Ñ–∞–∑
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ transparency_estimator.py # –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ pollution_analyzer.py # –ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ agro/                 # –ú–æ–¥—É–ª—å "–ê–≥—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agro_conditions_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plant_monitor_script.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _processes/       # –ù–û–í–û–ï: –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –∞–≥—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑–∞
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ soil_analyzer.py # –ê–Ω–∞–ª–∏–∑ –ø–æ—á–≤—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ growth_predictor.py # –ü—Ä–æ–≥–Ω–æ–∑ —Ä–æ—Å—Ç–∞
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ harvest_optimizer.py # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ settings/             # –ù–û–í–û–ï: –°–∫—Ä–∏–ø—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ       ‚îú‚îÄ‚îÄ add_location_script.py
‚îÇ       ‚îú‚îÄ‚îÄ remove_location_script.py
‚îÇ       ‚îú‚îÄ‚îÄ set_default_location_script.py
‚îÇ       ‚îî‚îÄ‚îÄ _processes/       # –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ           ‚îú‚îÄ‚îÄ coordinate_validator.py # –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
‚îÇ           ‚îî‚îÄ‚îÄ geocoder.py   # –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π
‚îú‚îÄ‚îÄ workers/                  # –ù–û–í–û–ï: –§–æ–Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ data_fetcher_worker.py # –í–æ—Ä–∫–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ notification_worker.py # –í–æ—Ä–∫–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ health_check_worker.py # –í–æ—Ä–∫–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ cleanup_worker.py     # –í–æ—Ä–∫–µ—Ä –æ—á–∏—Å—Ç–∫–∏
‚îú‚îÄ‚îÄ tests/                    # –ù–û–í–û–ï: –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ unit/                 # –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ integration/          # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ stress/               # –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ logs/                     # –ü–∞–ø–∫–∞ –¥–ª—è –ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ app.log              # –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥
‚îÇ   ‚îú‚îÄ‚îÄ process.log          # –õ–æ–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ errors.log           # –õ–æ–≥ –æ—à–∏–±–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ debug.log            # –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥
‚îú‚îÄ‚îÄ temp/                     # –ù–û–í–û–ï: –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ cache/               # –ö—ç—à –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ uploads/             # –ó–∞–≥—Ä—É–∑–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ reports/             # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
‚îú‚îÄ‚îÄ data/                     # –ü–∞–ø–∫–∞ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ docs/                     # –ù–û–í–û–ï: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ architecture.md      # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ api_docs.md          # API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ deployment.md        # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ requirements.txt


–û—Ç–ª–∏—á–Ω–æ, –ê—Ä—Ö—ã—Å! –ü—Ä–∏–Ω–∏–º–∞—é ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—é **–ø–æ–ª–Ω—É—é –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É** —Å –µ—ë –±–æ–≥–∞—Ç–æ–π –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å—é, –≤–∫–ª—é—á–∞—è `workers/`, `_processes/`, `monitoring/`, `models/` –∏ —Ç.–¥. –¢–µ–ø–µ—Ä—å –ø–æ—Å—Ç—Ä–æ—é **—Ç–æ—á–Ω—É—é –±–ª–æ—á–Ω–æ-–ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π**, **—Å—Ç—Ä–æ–≥–æ –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —ç—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É**, –±–µ–∑ —É–ø—Ä–æ—â–µ–Ω–∏–π.

–¶–µ–ª—å ‚Äî –¥–∞—Ç—å —Ç–µ–±–µ **–≥–æ—Ç–æ–≤—ã–π –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ¬´–¥–æ—Ä–æ–∂–Ω—ã–π –ø–ª–∞–Ω¬ª** —Å —á—ë—Ç–∫–∏–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏, –∑–∞–ø—Ä–µ—Ç–∞–º–∏ –Ω–∞ –∏–º–ø–æ—Ä—Ç—ã –∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

---

## üî∑ –û–ë–©–ò–ï –ü–†–ê–í–ò–õ–ê –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø (–¥–ª—è –≤—Å–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)

### ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:
- **bot.py ‚Üí core/** (–≤—Å–µ –ø–æ–¥–º–æ–¥—É–ª–∏)
- **process_manager.py ‚Üí core/** –∏ **scripts/**
- **scripts/ ‚Üí core/utils, core/db/local_*, core/models**
- **workers/ ‚Üí core/** –∏ **scripts/**
- **core/ ‚Üí –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è** (–Ω–æ –±–µ–∑ —Ü–∏–∫–ª–æ–≤)
- **scripts/ ‚Üí —Å–≤–æ–∏ _processes/**
- **settings-—Å–∫—Ä–∏–ø—Ç—ã ‚Üí core/db/central_db.py**

### ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ:
- **scripts/ ‚Üí bot.py**, **workers/ ‚Üí bot.py**
- **core/ ‚Üí scripts/**, **core/ ‚Üí workers/**
- **scripts/ ‚Üí core/db/central_db.py** (–∫—Ä–æ–º–µ `/settings/`)
- **_processes/ ‚Üí scripts/** (—Ç–æ–ª—å–∫–æ –Ω–∞–æ–±–æ—Ä–æ—Ç)
- –õ—é–±—ã–µ **—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã**

---

# üî∑ –ë–õ–û–ö 0. –ü–£–°–ö –°–ò–°–¢–ï–ú–´

### –ü—Ä–æ—Ü–µ–¥—É—Ä–∞: `python bot.py`
```python
# bot.py
from core.db.central_db import init_db
from core.monitoring.health_checker import start_health_check
from workers.health_check_worker import HealthCheckWorker
from core.event_bus import subscribe_async  # ‚Üê —Å–º. –Ω–∏–∂–µ

def main():
    # 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
    init_db()  # —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã, –≤–∫–ª—é—á–∞—è user_locations
    
    # 2. –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
    health_worker = HealthCheckWorker()
    asyncio.create_task(health_worker.run())
    
    # 3. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
    subscribe_async("task_result", handle_task_result)
    
    # 4. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    bot.polling()
```

> ‚úÖ **bot.py** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é.

---

# üî∑ –ë–õ–û–ö 1. –£–ü–†–ê–í–õ–ï–ù–ò–ï –õ–û–ö–ê–¶–ò–Ø–ú–ò (settings)

## 1.1. –§—Ä–æ–Ω—Ç ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏
```python
# bot.py
from scripts.settings.add_location_script import run as add_location  # ‚Üê –ù–ï–¢! –ù–µ–ª—å–∑—è –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã

# –í–ú–ï–°–¢–û –≠–¢–û–ì–û:
from process_manager import enqueue_script

async def on_location_received(user_id, lat, lon):
    name = "–î–æ–º"  # –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç—å
    task = await enqueue_script(
        script_path="scripts/settings/add_location_script.py",
        args=[str(user_id), str(lat), str(lon), name]
    )
```

> ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `process_manager`**, **–ù–ï –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è**!

## 1.2. –°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```python
# scripts/settings/add_location_script.py
import sys
from core.db.central_db import add_user_location  # ‚Üê —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –¥–ª—è settings!
from core.utils.geocoder import reverse_geocode

def main():
    user_id, lat, lon, name = sys.argv[1:5]
    if not name:
        name = reverse_geocode(lat, lon) or f"–¢–æ—á–∫–∞ {lat}"
    
    loc_id = add_user_location(user_id, name, float(lat), float(lon))
    
    # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    print(f"EVENT_TYPE:location_saved")
    print(f"USER_ID:{user_id}")
    print(f"MESSAGE:‚úÖ –õ–æ–∫–∞—Ü–∏—è '{name}' —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")
    print(f"LOCATION_ID:{loc_id}")

if __name__ == "__main__":
    main()
```

## 1.3. –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```python
# scripts/settings/_processes/coordinate_validator.py
from core.utils.validator import validate_coordinates

def safe_add_location(user_id, lat, lon, name):
    if not validate_coordinates(lat, lon):
        raise ValueError("Invalid coordinates")
    # ... –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
```

---

# üî∑ –ë–õ–û–ö 2. –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ô –°–ö–†–ò–ü–¢ (–Ω–∞ –ø—Ä–∏–º–µ—Ä–µ `weather_today_script.py`)

## 2.1. –ó–∞–ø—É—Å–∫ –∏–∑ –±–æ—Ç–∞
```python
# bot.py
async def weather_command(user_id):
    locations = get_user_locations(user_id)  # from core.db.central_db
    lat, lon = select_location(locations)    # –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞
    await enqueue_script("scripts/weather/weather_today_script.py", [lat, lon, user_id])
```

## 2.2. –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
```python
# scripts/weather/weather_today_script.py
import sys
from core.utils.api_client import OpenMeteoClient
from scripts.weather._processes.data_fetcher import fetch_weather_data
from scripts.weather._processes.interpolator import interpolate_to_hourly
from scripts.weather._processes.formatter import format_weather_report
from core.utils.cache_manager import save_plot_to_data
from core.db.local_db_weather import cache_weather

def main():
    lat, lon, user_id = map(float, sys.argv[1:3]) + [int(sys.argv[3])]
    
    # –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã
    raw = fetch_weather_data(lat, lon)            # ‚Üí _processes/data_fetcher.py
    hourly = interpolate_to_hourly(raw)           # ‚Üí _processes/interpolator.py
    report = format_weather_report(hourly)        # ‚Üí _processes/formatter.py
    
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
    cache_weather(user_id, lat, lon, hourly)      # ‚Üí core/db/local_db_weather.py
    graph_path = save_plot_to_data(report, f"weather_{user_id}.png")
    
    # –í—ã–≤–æ–¥
    print(f"EVENT_TYPE:task_result")
    print(f"RESULT_TYPE:graph")
    print(f"USER_ID:{user_id}")
    print(f"FILE_PATH:{graph_path}")

if __name__ == "__main__":
    main()
```

> ‚úÖ –ö–∞–∂–¥—ã–π —Å–∫—Ä–∏–ø—Ç ‚Äî **–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–¥–ø—Ä–æ—Ü–µ—Å—Å–æ–≤**, –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫–∏ –≤–Ω—É—Ç—Ä–∏.

---

# üî∑ –ë–õ–û–ö 3. –ü–û–î–ü–†–û–¶–ï–°–°–´ (_processes/)

## –ü—Ä–∏–º–µ—Ä: `scripts/weather/_processes/data_fetcher.py`
```python
# scripts/weather/_processes/data_fetcher.py
from core.utils.api_client import OpenMeteoClient
from core.utils.error_handler import log_and_raise

def fetch_weather_data(lat: float, lon: float):
    try:
        client = OpenMeteoClient()
        return client.get_hourly_forecast(lat, lon, days=7)
    except Exception as e:
        log_and_raise("Weather API fetch failed", e)
```

> ‚úÖ –ü–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî **—á–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**, **–±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤**, **–±–µ–∑ –≤—ã–≤–æ–¥–∞**.

---

# üî∑ –ë–õ–û–ö 4. PROCESS MANAGER + EVENT BUS

## 4.1. –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏
```python
# process_manager.py
import asyncio, subprocess
from core.event_bus import emit_event

async def enqueue_script(script_path: str, args: list[str]):
    proc = await asyncio.create_subprocess_exec(
        sys.executable, script_path, *args,
        stdout=subprocess.PIPE, stderr=subprocess.PIPE
    )
    asyncio.create_task(_wait_and_parse(proc))
```

## 4.2. –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```python
# process_manager.py
async def _wait_and_parse(proc):
    stdout, stderr = await proc.communicate()
    lines = stdout.decode().strip().split('\n')
    event = {}
    for line in lines:
        if ':' in line:
            key, val = line.split(':', 1)
            event[key.strip()] = val.strip()
    
    if proc.returncode == 0:
        await emit_event("task_result", event)
    else:
        await emit_event("task_error", {"error": stderr.decode(), **event})
```

## 4.3. –®–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π (–ù–ï–í–ò–î–ò–ú–ê–Ø –¥–ª—è –≤—Å–µ—Ö, –∫—Ä–æ–º–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤)
```python
# core/event_bus.py
_listeners = {}

def subscribe(event_type: str, handler):
    _listeners.setdefault(event_type, []).append(handler)

async def emit_event(event_type: str,  dict):
    for handler in _listeners.get(event_type, []):
        if asyncio.iscoroutinefunction(handler):
            asyncio.create_task(handler(data))
        else:
            handler(data)
```

> ‚úÖ `core/event_bus.py` ‚Äî **0 –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**, **0 –∏–º–ø–æ—Ä—Ç–æ–≤ –∏–∑–≤–Ω–µ**.

---

# üî∑ –ë–õ–û–ö 5. –û–ë–†–ê–¢–ù–ê–Ø –°–í–Ø–ó–¨ ‚Üí –ë–û–¢

```python
# bot.py
from core.event_bus import subscribe

async def handle_task_result(event: dict):
    user_id = int(event["USER_ID"])
    if event["RESULT_TYPE"] == "graph":
        await bot.send_photo(user_id, open(event["FILE_PATH"], "rb"))
    elif "MESSAGE" in event:
        await bot.send_message(user_id, event["MESSAGE"])

# –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
subscribe("task_result", handle_task_result)
subscribe("task_error", handle_task_result)
```

> ‚úÖ –ë–æ—Ç **–ø–æ–¥–ø–∏—Å–∞–Ω**, –Ω–æ **–Ω–∏–∫—Ç–æ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç bot.py**.

---

# üî∑ –ë–õ–û–ö 6. –ú–û–î–ï–õ–ò –ò –ú–û–ù–ò–¢–û–†–ò–ù–ì

## 6.1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ML-–º–æ–¥–µ–ª–∏
```python
# scripts/meteo/impact_forecast_script.py
from core.models.meteo_model import MeteoImpactModel

def main():
    # ... –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ...
    model = MeteoImpactModel()
    risk_score = model.predict(meteo_features)
    # ... –≤—ã–≤–æ–¥ ...
```

## 6.2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑ workers/
```python
# workers/health_check_worker.py
from core.monitoring.health_checker import check_db, check_api
from core.monitoring.performance_monitor import log_cpu_usage

class HealthCheckWorker:
    async def run(self):
        while True:
            check_db()
            check_api()
            log_cpu_usage()
            await asyncio.sleep(300)
```

---

# üî∑ –ë–õ–û–ö 7. –õ–û–ì–ò–†–û–í–ê–ù–ò–ï –ò –û–®–ò–ë–ö–ò

- –í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–µ–¥–∏–Ω—ã–π –ª–æ–≥–≥–µ—Ä** –∏–∑ `config/logging_config.py`
- –û—à–∏–±–∫–∏ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö ‚Üí `stderr` ‚Üí `process_manager` ‚Üí —Å–æ–±—ã—Ç–∏–µ ‚Üí –±–æ—Ç
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ ‚Üí `logs/errors.log`
- –û—Ç–ª–∞–¥–∫–∞ ‚Üí `logs/debug.log`

---

# üî∑ –ë–õ–û–ö 8. –ò–ï–†–ê–†–•–ò–Ø –ò–ú–ü–û–†–¢–û–í (—Ç–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞)

```
bot.py
‚îú‚îÄ core/event_bus.py
‚îú‚îÄ core/db/central_db.py
‚îú‚îÄ process_manager.py
‚îÇ  ‚îú‚îÄ core/event_bus.py
‚îÇ  ‚îî‚îÄ (subprocess ‚Üí scripts/ ‚Äî –ù–ï –∏–º–ø–æ—Ä—Ç!)
‚îÇ
scripts/weather/weather_today_script.py
‚îú‚îÄ scripts/weather/_processes/data_fetcher.py
‚îÇ  ‚îî‚îÄ core/utils/api_client.py
‚îú‚îÄ core/db/local_db_weather.py
‚îî‚îÄ core/utils/cache_manager.py

scripts/settings/add_location_script.py
‚îî‚îÄ core/db/central_db.py  ‚Üê –ï–î–ò–ù–°–¢–í–ï–ù–ù–û–ï –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø–∏—Å–∏

workers/notification_worker.py
‚îú‚îÄ core/event_bus.py
‚îî‚îÄ core/db/process_log_db.py
```

---

# ‚úÖ –ò–¢–û–ì: –ö–ê–ö –†–ï–ê–õ–ò–ó–û–í–´–í–ê–¢–¨

1. **–°–æ–∑–¥–∞–π –ø–∞–ø–∫–∏ –∏ `__init__.py`** –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ.
2. **–†–µ–∞–ª–∏–∑—É–π `core/event_bus.py`** ‚Äî –æ–Ω –Ω—É–∂–µ–Ω –≤—Å–µ–º.
3. **–°–¥–µ–ª–∞–π `process_manager.py`** ‚Äî –æ–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å—ë.
4. **–ù–∞–ø–∏—à–∏ `bot.py`** ‚Äî —Ç–æ–ª—å–∫–æ –≤–≤–æ–¥/–≤—ã–≤–æ–¥ + –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è.
5. **–î–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏**:
   - –°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç –≤ `scripts/–º–æ–¥—É–ª—å/`
   - –†–∞–∑–±–µ–π –ª–æ–≥–∏–∫—É –Ω–∞ –ø–æ–¥–ø—Ä–æ—Ü–µ—Å—Å—ã –≤ `_processes/`
   - –ò—Å–ø–æ–ª—å–∑—É–π `core/utils/` –¥–ª—è –æ–±—â–∏—Ö –∑–∞–¥–∞—á
   - –°–æ—Ö—Ä–∞–Ω—è–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `core/db/local_db_*`
6. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–∫–∞—Ü–∏–π** ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ, –∫—Ç–æ –ø–∏—à–µ—Ç –≤ `central_db`.

---

–•–æ—á–µ—à—å, —á—Ç–æ–±—ã —è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª **–ø–æ–ª–Ω—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏** –¥–ª—è:
- `core/event_bus.py`
- `process_manager.py`
- `scripts/weather/weather_today_script.py` + –µ–≥–æ `_processes/`
- `bot.py` (—á–∞—Å—Ç—å —Å –ø–æ–¥–ø–∏—Å–∫–æ–π)

–ì–æ—Ç–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å!
–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
1. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö (–¶–ë–î)
–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: user_locations
user_id (int, primary key, foreign key -> users table)
location_id (int, primary key, autoincrement)
name (str) - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ—á–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–î–æ–º", "–î–∞—á–∞", "–†–∞–±–æ—Ç–∞").
lat (float) - —à–∏—Ä–æ—Ç–∞.
lon (float) - –¥–æ–ª–≥–æ—Ç–∞.
is_default (bool) - —Ñ–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–æ—á–∫–∞ —Ç–æ—á–∫–æ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
2. –ú–µ–Ω—é "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
–ù–æ–≤—ã–π –ø–æ–¥–ø—É–Ω–∫—Ç: "–ú–æ–∏ —Ç–æ—á–∫–∏" (–∏–ª–∏ "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã", "–õ–æ–∫–∞—Ü–∏–∏").
2.1. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ—á–µ–∫: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ "–í—ã–±—Ä–∞—Ç—å", "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å", "–£–¥–∞–ª–∏—Ç—å". –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é".
2.2. –î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É:
–ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ü—Ä–∏—à–ª–∏—Ç–µ –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ '—à–∏—Ä–æ—Ç–∞, –¥–æ–ª–≥–æ—Ç–∞'."
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é –∏–ª–∏ —Ç–µ–∫—Å—Ç.
–ë–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ (–º–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–¢–æ—á–∫–∞ X").
–í—ã–∑—ã–≤–∞–µ—Ç scripts/settings/add_location_script.py (–∞—Ä–≥—É–º–µ–Ω—Ç—ã: user_id, lat, lon, name).
–°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ—á–∫—É –≤ user_locations (–¶–ë–î).
2.3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫—É: –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ç–æ—á–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ -> –≤–≤–æ–¥ –Ω–æ–≤–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è/–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (—á–µ—Ä–µ–∑ –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é –∏–ª–∏ —Ç–µ–∫—Å—Ç).
2.4. –£–¥–∞–ª–∏—Ç—å —Ç–æ—á–∫—É: –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ç–æ—á–∫–∞ -> –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -> –≤—ã–∑–æ–≤ scripts/settings/remove_location_script.py (–∞—Ä–≥—É–º–µ–Ω—Ç—ã: user_id, location_id).
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
–ü—Ä–∏ –≤—ã–∑–æ–≤–µ –ª—é–±–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, weather_today_script.py, agro_conditions_script.py):
bot.py –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
bot.py –≤—ã–∑—ã–≤–∞–µ—Ç core/db/central_db.py -> get_user_locations(user_id).
–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ç–æ—á–∫–∞, –∏–ª–∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –æ–¥–Ω–∞ —Ç–æ—á–∫–∞, –ø–æ–º–µ—á–µ–Ω–Ω–∞—è –∫–∞–∫ is_default, –∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –≤—ã–±–æ—Ä —Ç–æ—á–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"), —Ç–æ bot.py –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É —Ç–æ—á–∫—É –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å –µ—ë –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏.
–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–µ–∫ –∏ –Ω–∏ –æ–¥–Ω–∞ –Ω–µ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ is_default, –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –≤—ã–±–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª "–ü—Ä–æ–≥–Ω–æ–∑ –¥–ª—è..."), —Ç–æ bot.py –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏, –≥–¥–µ –∫–∞–∂–¥–∞—è –∫–Ω–æ–ø–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–π –∏–∑ —Ç–æ—á–µ–∫ (name —Ç–æ—á–∫–∏). –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏, bot.py –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å –Ω–∏–º–∏.
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–∏–º–∏.
4. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –ª–æ–≥–∏—á–Ω–æ)
scripts/settings/add_location_script.py: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç core/db/central_db.py –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ user_locations.
scripts/settings/remove_location_script.py: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç core/db/central_db.py –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –∏–∑ user_locations.
scripts/settings/set_default_location_script.py: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç core/db/central_db.py –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–ª–∞–≥–∞ is_default.
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–ü–æ–≥–æ–¥–∞, –ú–µ—Ç–µ–æ, –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞, –ê–≥—Ä–æ–ø—Ä–æ–≥–Ω–æ–∑) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.
–£–¥–æ–±—Å—Ç–≤–æ: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ —Ç–æ—á–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
–ì–∏–±–∫–æ—Å—Ç—å: –ú–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å —Ç–æ—á–∫—É –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—á–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–æ—á–µ–∫ –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤—ã–±–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ—Å–ª–µ–¥–Ω—è—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è").
–ò–∑–æ–ª—è—Ü–∏—è: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–µ –∑–∞–±–æ—Ç—è—Ç—Å—è –æ —Ç–æ–º, –∫–∞–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã. –ò–º –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è lat –∏ lon.
–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:
core/db/central_db.py –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:
get_user_locations(user_id)
add_user_location(user_id, name, lat, lon, is_default=False)
update_user_location(user_id, location_id, name=None, lat=None, lon=None, is_default=None)
remove_user_location(user_id, location_id)
set_default_location(user_id, location_id)
bot.py –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ª–æ–≥–∏–∫—É:
–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–æ—á–µ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏.
–û–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ç–æ—á–∫–∏.
–í—ã–∑–æ–≤–∞ get_user_locations –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –¶–ë–î –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.